#!/bin/sh
retest() {
    printf "\033c"
    echo "----------------------------------------"
    date +%Y-%m-%d-%H:%M:%S
    echo "----------------------------------------"
    make -j3 config=release_sse test && bin/release/test;
#    make -j3 config=release_no_sse test && bin/release/test;
}

make config=release_sse clean
#make config=release_no_sse clean
retest

export -f retest
fswatch -o src test | xargs -n1 -I{} bash -c 'retest' _ {}
